(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8594],{87622:function(t,e,r){var a=r(13940),s=r(36740)(function(t,e,r){a(t,r,e)});t.exports=s},68756:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/reports",function(){return r(89818)}])},89818:function(t,e,r){"use strict";r.r(e),r.d(e,{UserReportPage:function(){return m}});var a=r(52322),s=r(59491),n=r(5632),o=r(2784),i=r(82671),l=r(38406),c=r(3593),u=r(37107),d=r(9575),h=r(13096),p=r(8237),f=r(34128);let m=()=>{let[t,e]=(0,o.useState)(!0),r=(0,n.useRouter)(),{ref:c}=(0,i.UO)(),{profile:m}=(0,p.Un)(),[y,w]=(0,o.useState)(!1),T=(0,f.I)(c),_=(0,h.Xo)(s.KA.CREATE,"user_content",{resource:{type:"report",owner_id:null==m?void 0:m.id},subject:{id:null==m?void 0:m.id}});async function j(){await T.load();let t=T.reports();t.length>=1?r.push("/project/".concat(c,"/reports/").concat(t[0].id)):e(!1)}return(0,o.useEffect)(()=>{j()},[c]),(0,a.jsx)("div",{className:"mx-auto my-32 w-full max-w-7xl flex-grow space-y-16",children:t?(0,a.jsx)(d.Z,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.Z,{title:"Reports",ctaButtonLabel:"New custom report",onClickCta:()=>{w(!0)},disabled:!_,disabledMessage:"You need additional permissions to create a report",children:[(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:"Create custom reports for your projects."}),(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:"Get a high level overview of your network traffic, user actions, and infrastructure health."})]}),(0,a.jsx)(l.m,{visible:y,onCancel:()=>{w(!1)},afterSubmit:()=>{w(!1)}})]})})};m.getLayout=t=>(0,a.jsx)(c.li,{children:t}),e.default=m},34128:function(t,e,r){"use strict";r.d(e,{I:function(){return d}});var a=r(87612),s=r(80075),n=r(71436),o=r(87622),i=r.n(o),l=r(76626);let c=null,u=null;function d(t){return(null===c||t!==u)&&(u=t,c=new h("".concat(l.T5,"/projects/").concat(t,"/content"))),c}class h{async fetchData(){let t=await (0,n.U2)(this.url,{headers:{"Content-Type":"application/json"}});if(t.error)throw t.error;return this.data=t.data.length>0?i()(t.data,"id"):t.data,t}async load(){let{LOADING:t,ERROR:e,LOADED:r}=this.STATES;try{return this.error=null,this.state=t,await this.fetchData(),this.state=r,this.data}catch(t){console.error("e.message",t.message),this.error=t,this.state=e}}get hasError(){return this.state===this.STATES.ERROR}get isLoading(){return this.state===this.STATES.INITIAL||this.state===this.STATES.LOADING}list(t){let e=Object.values(this.data);return t?e.filter(t).sort((t,e)=>t.name.localeCompare(e.name)):e.sort((t,e)=>t.name.localeCompare(e.name))}reports(t){let e=Object.values(this.data);return t?e.filter(t=>"report"==t.type).filter(t).sort((t,e)=>t.name.localeCompare(e.name)):e.filter(t=>"report"==t.type).sort((t,e)=>t.name.localeCompare(e.name))}sqlSnippets(t){let e=Object.values(this.data);return t?e.filter(t=>"sql"==t.type).filter(t).sort((t,e)=>t.name.localeCompare(e.name)):e.filter(t=>"sql"==t.type).sort((t,e)=>t.name.localeCompare(e.name))}byId(t){return this.data[t]}async create(t){try{let e=await (0,n.v_)(this.url,t,{headers:{"Content-Type":"application/json"}});if(e.error)throw e.error;return this.data[e.id]=e,{data:e,error:null}}catch(t){return{data:null,error:t}}}async update(t,e,r){try{let a={...e,type:r,id:t},s="".concat(this.url,"?id=").concat(t),o=await (0,n.r$)(s,a,{headers:{"Content-Type":"application/json"}});if(o.error)throw o.error;return this.data[t]=o,{data:o,error:null}}catch(t){return{data:null,error:t}}}async updateSql(t,e){return this.update(t,e,"sql")}async updateReport(t,e){return this.update(t,e,"report")}async del(t){try{let e="".concat(this.url,"?id=").concat(t),r=await (0,n.$v)(e,{},{headers:{"Content-Type":"application/json"}});if(r.error)throw r.error;return delete this.data[t],{data:!0,error:null}}catch(t){return{data:!1,error:t}}}constructor(t){(0,a._)(this,"STATES",{INITIAL:"initial",LOADING:"loading",ERROR:"error",LOADED:"loaded"}),(0,a._)(this,"rootStore",null),(0,a._)(this,"url",""),(0,a._)(this,"state",this.STATES.INITIAL),(0,a._)(this,"data",{}),(0,a._)(this,"error",null),this.url=t,(0,s.rC)(this,{state:s.LO,data:s.LO,list:s.LO,hasError:s.Fl,isLoading:s.Fl})}}}},function(t){t.O(0,[667,9678,8183,8421,3844,3145,8286,3517,5022,6751,1421,5573,1761,5232,2550,4056,3501,7689,6647,6909,5952,1685,9298,9774,2888,179],function(){return t(t.s=68756)}),_N_E=t.O()}]);