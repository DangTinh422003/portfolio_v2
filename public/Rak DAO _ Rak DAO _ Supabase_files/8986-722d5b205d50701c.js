"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8986],{29663:function(e,o,t){t.d(o,{c:function(){return U}});var n=t(52322),s=t(24990),i=t(24459),l=t(5632),a=t(2784),r=t(12467),c=t(27792),d=t(96383),u=t(25463),p=t(31840),v=t(66650),h=t(83314),m=t(33105),x=t(51113),f=t(40068),g=t(54175),j=t(25622),b=t(67072),N=t(238),w=t(5388),_=t(5590),y=t(75683),S=t(95522),C=t(35912),A=t(76927),I=t(81693),P=t(30877),E=t(81395);let T=[{id:"uri",label:"URI"},{id:"psql",label:"PSQL"},{id:"golang",label:"Golang"},{id:"jdbc",label:"JDBC"},{id:"dotnet",label:".NET"},{id:"nodejs",label:"Nodejs"},{id:"php",label:"PHP"},{id:"python",label:"Python"}],U=e=>{var o,t;let{appearance:U}=e,k=(0,l.useRouter)(),R=(0,i.Mk)(),{ref:D,connectionString:Z}=(0,i.UO)(),O=(0,S.mM)(),W=(0,y.TF)(),{project:q,isLoading:H}=(0,h.d2)(),F=null==q?void 0:q.is_read_replicas_enabled,M=(0,a.useRef)(null),[L,z]=(0,a.useState)("session"),[Y,B]=(0,a.useState)("uri"),{data:X,isSuccess:V}=(0,b.Y)({projectRef:D}),J=F?null==X?void 0:X.find(e=>e.identifier===W.selectedDatabaseId):null==X?void 0:X.find(e=>"PRIMARY"===e.database_type),{data:K,error:Q,isLoading:G,isError:$,isSuccess:ee}=(0,j.o)({projectRef:D}),{data:eo,error:et,isLoading:en,isError:es,isSuccess:ei}=(0,N.b)({projectRef:D}),el=(null!=eo?eo:[]).find(e=>e.identifier===W.selectedDatabaseId),{project:ea}=null!=K?K:{},er=["db_host","db_name","db_port","db_user","inserted_at"],ec={db_user:"",db_host:"",db_port:"",db_name:""},ed=F?(0,w.Ff)(el||ec,er):(0,w.Ff)(ea||ec,er),eu=(null==q?void 0:q.restUrl)!==void 0&&null!==(t=new URL(null!==(o=null==q?void 0:q.restUrl)&&void 0!==o?o:"").hostname.split(".").pop())&&void 0!==t?t:"co",ep=e=>{var o;let t=null===(o=T.find(o=>o.id===e))||void 0===o?void 0:o.label;_.Z.sendEvent({category:"settings",action:"copy_connection_string",label:t||""},R,k)},ev=V&&void 0!==J?(0,I.xI)(ed,J,{projectRef:D,usePoolerConnection:O.usePoolerConnection}):{uri:"",psql:"",golang:"",jdbc:"",dotnet:"",nodejs:"",php:"",python:""},eh=V&&void 0!==J?(0,I.Ak)(null==J?void 0:J.connectionString):"com",em=V&&void 0!==J?(0,I.a4)(null==J?void 0:J.connectionString,{selectedTab:Y,usePoolerConnection:O.usePoolerConnection,ref:D,cloudProvider:H?"":(null==ea?void 0:ea.cloud_provider)||"",region:H?"":(null==ea?void 0:ea.region)||"",tld:O.usePoolerConnection?eh:eu,portNumber:O.usePoolerConnection?"transaction"===L?null==J?void 0:J.db_port.toString():"5432":ed.db_port.toString()}):[];return(0,a.useEffect)(()=>{if(F&&void 0!==Z&&void 0!==M.current){var e;W.setSelectedDatabaseId(Z),null===(e=M.current)||void 0===e||e.scrollIntoView({block:"center",behavior:"smooth"})}},[Z]),(0,a.useEffect)(()=>{(null==J?void 0:J.pool_mode)==="session"&&z(J.pool_mode)},[null==J?void 0:J.pool_mode]),(0,n.jsx)("div",{id:"connection-string",className:"w-full",children:(0,n.jsxs)(f.Z,{className:(0,r.cn)("!m-0 [&>div:nth-child(1)]:!border-0 [&>div:nth-child(1)>div]:!p-0","minimal"===U&&"border-0 shadow-none"),bodyClassName:(0,r.cn)("minimal"===U&&"bg-transparent"),titleClasses:(0,r.cn)("minimal"===U&&"bg-transparent"),title:(0,n.jsxs)("div",{ref:M,className:(0,r.cn)("w-full flex flex-col","default"===U?"pt-4":"pt-0"),children:[(0,n.jsxs)("div",{className:(0,r.cn)("flex items-center justify-between mb-2","default"===U&&"px-6"),children:["default"===U&&(0,n.jsx)("h5",{className:"mb-0",children:"Connection string"},"panel-title"),(0,n.jsxs)("div",{className:(0,r.cn)("flex items-center gap-x-2 ml-auto","minimal"===U?"absolute -top-1 right-0":""),children:[F&&(0,n.jsx)(x.Z,{}),(0,n.jsx)(c.z,{asChild:!0,type:"default",icon:(0,n.jsx)(P.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connecting-to-postgres",children:"Documentation"})})]})]}),(0,n.jsx)(d.Z,{type:"underlined",size:"tiny",activeId:Y,baseClassNames:(0,r.cn)("!space-y-0 px-6 -mb-[1px]","minimal"===U&&"-mt-1 px-0"),onChange:B,children:T.map(e=>(0,n.jsx)(d.Z.Panel,{id:e.id,label:e.label},e.id))}),(0,n.jsx)(u.Z,{})]}),children:[(0,n.jsxs)(f.Z.Content,{className:"minimal"===U&&"px-0",children:[(F?en:G)&&(0,n.jsx)(g.Z,{className:"h-8 w-full"}),(F?es:$)&&(0,n.jsx)(m.Z,{error:F?et:Q,subject:"Failed to retrieve database settings"}),(F?ei:ee)&&(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 pt-2",children:[(0,n.jsx)(A.K,{id:"connection-string",checked:O.usePoolerConnection,poolingMode:L,onCheckedChange:O.setUsePoolerConnection,onSelectPoolingMode:z}),!O.usePoolerConnection&&(0,n.jsx)(C.X,{}),(0,n.jsx)(p.Z,{copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100",value:"transaction"===L?ev[Y]:ev[Y].replace("6543","5432"),onCopy:()=>ep(Y)})]})]}),em.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{}),(0,n.jsxs)(f.Z.Content,{className:(0,r.cn)("!py-3 space-y-2","minimal"===U&&"px-0"),children:[(0,n.jsxs)(v.zF,{children:[(0,n.jsx)(v.wy,{className:"group [&[data-state=open]>div>svg]:!-rotate-180",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"How to connect to a different database or switch to another user"}),(0,n.jsx)(E.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,n.jsx)(v.Fw,{className:"my-2",children:(0,n.jsxs)("div",{className:"text-foreground-light",children:[(0,n.jsxs)("p",{className:"text-xs",children:["You can use the following URI format to switch to a different database or user",O.usePoolerConnection?" when using connection pooling":"","."]}),(0,n.jsx)("p",{className:"text-sm font-mono tracking-tight text-foreground-lighter",children:em.map((e,o)=>e.tooltip?(0,n.jsxs)(s.fC,{delayDuration:0,children:[(0,n.jsx)(s.xz,{asChild:!0,children:(0,n.jsx)("span",{className:"text-foreground text-xs",children:e.value})}),(0,n.jsx)(s.h_,{children:(0,n.jsx)(s.h_,{children:(0,n.jsxs)(s.VY,{side:"bottom",children:[(0,n.jsx)(s.Eh,{className:"radix-tooltip-arrow"}),(0,n.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,n.jsx)("span",{className:"text-xs text-foreground",children:e.tooltip})})]})})})]},"syntax-".concat(o)):(0,n.jsx)("span",{className:"text-xs",children:e.value},"syntax-".concat(o)))})]})})]}),"python"===Y&&(0,n.jsxs)(v.zF,{children:[(0,n.jsx)(v.wy,{className:"group [&[data-state=open]>div>svg]:!-rotate-180",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"Connecting to SQL Alchemy"}),(0,n.jsx)(E.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,n.jsx)(v.Fw,{className:"my-2",children:(0,n.jsxs)("div",{className:"text-foreground-light text-xs grid gap-2",children:[(0,n.jsxs)("p",{children:["Please use ",(0,n.jsx)("code",{children:"postgresql://"})," instead of ",(0,n.jsx)("code",{children:"postgres://"})," as your dialect when connecting via SQLAlchemy."]}),(0,n.jsxs)("p",{children:["Example:",(0,n.jsx)("code",{children:'create_engine("postgresql+psycopg2://...")'})]}),(0,n.jsx)("p",{className:"text-sm font-mono tracking-tight text-foreground-lighter"})]})})]})]})]})]})})}},81693:function(e,o,t){t.d(o,{Ak:function(){return d},a4:function(){return c},xI:function(){return n}});let n=(e,o,t)=>{let n=o.connectionString.includes("options=reference"),{usePoolerConnection:s,projectRef:i}=t,l=s?o.db_user:e.db_user,a=s?null==o?void 0:o.db_port:e.db_port,r=s?o.db_host:e.db_host,c=s?null==o?void 0:o.db_name:e.db_name,d="[YOUR-PASSWORD]",u=s&&n,p=s?null==o?void 0:o.connectionString:"postgresql://".concat(l,":").concat(d,"@")+"".concat(r,":").concat(a)+"/".concat(c),v="user=".concat(l," password=").concat(d," host=").concat(r," port=").concat(a," dbname=").concat(c).concat(u?" options=reference=".concat(i):"");return{psql:n?'psql "postgresql://'.concat(l,":").concat(d,"@").concat(r,":").concat(a,"/").concat(c).concat(s?"?options=reference%3D".concat(i):""):"psql -h ".concat(r," -p ")+"".concat(a," -d ").concat(c," ")+"-U ".concat(l),uri:p,golang:v,jdbc:"jdbc:postgresql://".concat(r,":").concat(a,"/").concat(c,"?user=").concat(l,"&password=").concat(d).concat(u?"&options=reference%3D".concat(i):""),dotnet:"User Id=".concat(l,";Password=").concat(d,";Server=").concat(r,";Port=").concat(a,";Database=").concat(c,";").concat(u?"Options='reference=".concat(i,"'"):""),nodejs:p,php:v,python:v}},s="Database user (e.g postgres)",i="Database password",l="Database name (e.g postgres)",a="Project's reference ID",r="Port number (Use 5432 if using prepared statements)",c=(e,o)=>{let{selectedTab:t,usePoolerConnection:n,ref:c,cloudProvider:d,region:u,tld:p,portNumber:v}=o,h=e.includes("options=reference"),m=[{value:d.toLocaleLowerCase(),tooltip:"Cloud provider"},{value:"-0-",tooltip:void 0},{value:u,tooltip:"Project's region"},{value:".pooler.supabase.".concat(p),tooltip:void 0}],x=[{value:"db.",tooltip:void 0},{value:c,tooltip:a},{value:".supabase.".concat(p),tooltip:void 0}];return"uri"===t||"nodejs"===t?h?[{value:"postgres://",tooltip:void 0},{value:"[user]",tooltip:s},{value:":",tooltip:void 0},{value:"[password]",tooltip:i},{value:"@",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:"?options=reference%3D",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"postgres://",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:":",tooltip:void 0},{value:"[password]",tooltip:i},{value:"@",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l}]:"psql"===t?h?[{value:'psql "postgresql://',tooltip:void 0},{value:"[user]",tooltip:s},{value:":",tooltip:void 0},{value:"[password]",tooltip:i},{value:"@",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:"?options=reference%3D",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"psql -h ",tooltip:void 0},...n?m:x,{value:" -p ",tooltip:void 0},{value:v,tooltip:r},{value:" -d ",tooltip:void 0},{value:"[db-name]",tooltip:l},{value:" -U ",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[]]:"golang"===t||"php"===t||"python"===t?h?[{value:"user=",tooltip:void 0},{value:"[user]",tooltip:s},{value:" password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:" host=",tooltip:void 0},...n?m:x,{value:" port=",tooltip:void 0},{value:v,tooltip:r},{value:" dbname=",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:" options=reference=",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"user=",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:" password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:" host=",tooltip:void 0},...n?m:x,{value:" port=",tooltip:void 0},{value:v,tooltip:r},{value:" dbname=",tooltip:void 0},{value:"[db-name]",tooltip:l}]:"jdbc"===t?h?[{value:"jdbc:postgresql://",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},{value:"?user=",tooltip:void 0},{value:"[user]",tooltip:s},{value:"&password=",tooltip:void 0},{value:"[password]",tooltip:i},...n?[{value:"&options=reference%3D",tooltip:void 0},{value:c,tooltip:a}]:[]]:[{value:"jdbc:postgresql://",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:l},{value:"?user=",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:"&password=",tooltip:void 0},{value:"[password]",tooltip:i}]:"dotnet"===t?h?[{value:"User Id=",tooltip:void 0},{value:"[user]",tooltip:s},{value:";Password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:";Server=",tooltip:void 0},...n?m:x,{value:";Port=",tooltip:void 0},{value:v,tooltip:r},{value:";Database=",tooltip:void 0},{value:"[db-name]",tooltip:l},...n?[{value:";Options='reference=",tooltip:void 0},{value:c,tooltip:a},{value:"'",tooltip:void 0}]:[]]:[{value:"User Id=",tooltip:void 0},{value:"[user]",tooltip:s},...n?[{value:".",tooltip:void 0},{value:c,tooltip:a}]:[],{value:";Password=",tooltip:void 0},{value:"[password]",tooltip:i},{value:";Server=",tooltip:void 0},...n?m:x,{value:";Port=",tooltip:void 0},{value:v,tooltip:r},{value:";Database=",tooltip:void 0},{value:"[db-name]",tooltip:l}]:[]},d=e=>{try{return e.split("pooler.supabase.")[1].split(":6543")[0]}catch(e){return"com"}}},35912:function(e,o,t){t.d(o,{X:function(){return r}});var n=t(52322),s=t(72860),i=t(66105),l=t(27792),a=t(39127);let r=()=>(0,n.jsxs)(s.bZ,{variant:"warning",children:[(0,n.jsx)(i.Z,{strokeWidth:2}),(0,n.jsx)(s.Cd,{children:"Direct database access via IPv4 and pgBouncer will be removed from January 26th 2024"}),(0,n.jsxs)(s.X,{className:"space-y-3",children:[(0,n.jsxs)("p",{children:["We strongly recommend using ",(0,n.jsx)("span",{className:"text-foreground",children:"connection pooling"})," to connect to your database. You'll only need to change the connection string that you're using in your application to the pooler's connection string."]}),(0,n.jsx)(l.z,{asChild:!0,type:"default",icon:(0,n.jsx)(a.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{href:"https://github.com/orgs/supabase/discussions/17817",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]})},30444:function(e,o,t){t.d(o,{F:function(){return m}});var n=t(52322),s=t(24459),i=t(41051),l=t(18773),a=t(27792),r=t(39127),c=t(72860),d=t(86073),u=t(83314),p=t(67072),v=t(75683),h=t(95522);let m=()=>{let{ref:e}=(0,s.UO)(),{project:o}=(0,u.d2)(),t=(0,h.mM)(),m=(0,v.TF)(),x=null==o?void 0:o.is_read_replicas_enabled,{data:f}=(0,p.Y)({projectRef:e}),g=x?null==f?void 0:f.find(e=>e.identifier===m.selectedDatabaseId):null==f?void 0:f.find(e=>"PRIMARY"===e.database_type),j=()=>{let e=document.getElementById("connection-pooler");e&&e.scrollIntoView({behavior:"smooth",block:"center"})};return(0,n.jsx)(l.Vq,{open:t.showPoolingModeHelper,onOpenChange:t.setShowPoolingModeHelper,children:(0,n.jsxs)(l.cZ,{hideClose:!0,className:"sm:max-w-4xl",children:[(0,n.jsxs)(l.fK,{className:"pb-0",children:[(0,n.jsx)(l.$N,{children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{className:"text-lg max-w-2xl",children:"Which pooling mode should I use?"}),(0,n.jsx)(a.z,{asChild:!0,type:"default",icon:(0,n.jsx)(r.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connecting-to-postgres#how-connection-pooling-works",target:"_blank",rel:"noreferrer",children:"Documentation"})})]})}),(0,n.jsx)(l.Be,{className:"text-lg max-w-2xl",children:"A connection pooler is a system (external to Postgres) which manages Postgres connections by allocating connections whenever clients make requests."})]}),(0,n.jsx)(l.P3,{}),(0,n.jsx)(d.U,{className:"px-6 max-w-full [&>h3]:text-sm",content:"\nEach pooling mode handles connections differently.\n\n### Transaction mode\nThis mode is recommended if you are connecting from *serverless environments*. A connection is assigned to the client for the duration of a transaction. Two consecutive transactions from the same client could be executed over two different connections. Some session-based Postgres features such as prepared statements are *not available* with this option.\n\n### Session mode\nThis mode is similar to connecting to your database directly. There is full support for prepared statements in this mode. When a new client connects, a connection is assigned to the client until it disconnects. You *might run into pooler connection limits* since the connection is held till the client disconnects.\n\n### Using session and transaction modes at the same time\n ".concat((null==g?void 0:g.pool_mode)==="transaction"?"You can use the session mode connection string (port 5432) and transaction mode connection string (port 6543) in your application.":"To get the best of both worlds, as a starting point, we recommend using session mode just when you need support for prepared statements and transaction mode in other cases.","\n")}),(null==g?void 0:g.pool_mode)==="session"&&(0,n.jsx)("div",{className:"px-6",children:(0,n.jsxs)(c.bZ,{variant:"warning",children:[(0,n.jsx)(i.Z,{strokeWidth:2}),(0,n.jsx)(c.Cd,{children:"Pooling mode is currently configured to use session mode"}),(0,n.jsxs)(c.X,{children:["To use transaction mode concurrently with session mode, change the pooling mode to transaction first in the"," ",(0,n.jsx)("span",{tabIndex:0,className:"text-foreground cursor-pointer underline underline-offset-2",onClick:()=>{t.setShowPoolingModeHelper(!1),j()},children:"connection pooling settings"}),". After this, you can use transaction mode on port 6543 and session mode on port 5432."]})]})}),(0,n.jsx)(l.cN,{children:(0,n.jsx)(l.GG,{onClick:()=>t.setShowPoolingModeHelper(!1),children:(0,n.jsx)(a.z,{type:"secondary",children:"Close"})})})]})})}},76927:function(e,o,t){t.d(o,{K:function(){return I}});var n=t(52322),s=t(24459),i=t(5632),l=t(2784),a=t(18227),r=t(40386),c=t(27792),d=t(56599),u=t(16166),p=t(25463),v=t(81733),h=t(83314),m=t(54175),x=t(36492),f=t(71824),g=t(49422),j=t(76626);async function b(e,o){let{projectRef:t}=e;if(void 0===t)throw Error("Project ref is required");let{data:n,error:s}=await (0,g.U2)("/platform/projects/{ref}/config/pgbouncer/status",{params:{path:{ref:t}}});if(s)throw s;return n}let N=function(e){let{projectRef:o}=e,{enabled:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,x.a)(f.U.pgBouncerStatus(o),e=>{let{signal:t}=e;return b({projectRef:o},t)},{enabled:t&&j.Qy&&void 0!==o,...n})};var w=t(25622),_=t(67072),y=t(75683),S=t(95522),C=t(39097),A=t.n(C);let I=e=>{let{id:o,checked:t,poolingMode:x="transaction",onCheckedChange:f,onSelectPoolingMode:g}=e,j=(0,i.useRouter)(),[b,C]=(0,l.useState)(!1),{ref:I}=(0,s.UO)(),{project:P}=(0,h.d2)(),E=(0,S.mM)(),T=(0,y.TF)(),{data:U,isLoading:k,isSuccess:R}=(0,_.Y)({projectRef:I}),{data:D,isSuccess:Z}=(0,w.o)({projectRef:I}),{data:O}=N({projectRef:I}),W=j.pathname.endsWith("/settings/database"),q=(null==P?void 0:P.is_read_replicas_enabled)?null==U?void 0:U.find(e=>e.identifier===T.selectedDatabaseId):null==U?void 0:U.find(e=>"PRIMARY"===e.database_type),H=(null==D?void 0:D.project.db_ip_addr_config)==="ipv6",F=e=>{g(e),C(!1)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex flex-col gap-y-1",children:(0,n.jsxs)("div",{className:"flex gap-x-3",children:[(0,n.jsx)(a.X,{id:"use-pooler-".concat(o),checked:t,onCheckedChange:()=>f(!t)}),(0,n.jsx)("div",{className:"-mt-[2px] flex flex-col gap-y-1 w-full",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)("label",{htmlFor:"use-pooler-".concat(o),className:"text-sm cursor-pointer",children:"Use connection pooling"}),t&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[k&&(0,n.jsx)(m.Z,{className:"w-[100px] py-2.5"}),R&&(0,n.jsx)("div",{className:"flex items-center gap-x-1",children:(0,n.jsxs)(r.h_,{open:b,onOpenChange:C,children:[(0,n.jsx)(r.$F,{asChild:!0,children:(0,n.jsx)(c.z,{type:"outline",className:"py-0.5 pr-1.5",iconRight:(0,n.jsx)(d.Z,{strokeWidth:1}),children:(0,n.jsxs)("span",{className:"capitalize",children:["Mode: ",x]})})}),(0,n.jsxs)(r.AW,{side:"bottom",align:"start",className:"w-[280px]",children:[(0,n.jsxs)(r.Xi,{className:"flex items-center justify-between",onClick:()=>F("session"),children:[(0,n.jsx)("span",{children:"Session mode"}),"session"===x&&(0,n.jsx)(u.Z,{className:"text-brand"})]},"session"),(null==q?void 0:q.pool_mode)==="transaction"&&(0,n.jsxs)(r.Xi,{className:"flex items-center justify-between",onClick:()=>F("transaction"),children:[(0,n.jsx)("span",{children:"Transaction mode"}),"transaction"===x&&(0,n.jsx)(u.Z,{className:"text-brand"})]},"transaction"),(null==q?void 0:q.pool_mode)==="session"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{className:"my-1"}),(0,n.jsxs)("div",{className:"px-2 text-xs flex flex-col gap-y-2",children:[(0,n.jsxs)("p",{children:["To use transaction mode, change the pool mode in the"," ",W?(0,n.jsx)("span",{tabIndex:0,className:"underline hover:text-foreground cursor-pointer transition",onClick:()=>{let e=document.getElementById("connection-pooler");e&&(C(!1),e.scrollIntoView({behavior:"smooth",block:"center"}))},children:"pooling configuration settings"}):(0,n.jsx)(A(),{href:"/project/".concat(I,"/settings/database#connection-pooler"),className:"underline hover:text-foreground",children:"pooling configuration settings"})," ","to use transaction mode first."]}),(0,n.jsx)("p",{children:"You can then connect to session mode on port 5432 and transaction mode on port 6543."})]})]}),(0,n.jsx)(p.Z,{className:"my-1"}),(0,n.jsx)(r.Xi,{onClick:()=>{C(!1),E.setShowPoolingModeHelper(!0)},children:"How to choose pooling modes?"},"more-info")]})]})})]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[R&&t&&(0,n.jsx)(v.C,{children:"Supavisor"}),Z&&(0,n.jsx)(v.C,{children:t?"Resolves to IPv4":H?"Resolves to IPv6":"Will resolve to IPv6"}),(null==O?void 0:O.active)&&(0,n.jsx)(v.C,{variant:"warning",children:"PgBouncer pending removal"})]})]})})]})})})}},42200:function(e,o,t){t.d(o,{B:function(){return l},F2:function(){return r},Y4:function(){return i},_J:function(){return c},dA:function(){return d},hV:function(){return u},hk:function(){return a},nK:function(){return s},q_:function(){return p}});var n=t(76626);let s=660,i=50,l=20,a={...n.S,INIT_READ_REPLICA:"INIT_READ_REPLICA",INIT_READ_REPLICA_FAILED:"INIT_READ_REPLICA_FAILED"},r={SOUTHEAST_ASIA:[103.8,1.37],NORTHEAST_ASIA:[139.42,35.41],NORTHEAST_ASIA_2:[126.98,37.56],CENTRAL_CANADA:[-73.6,45.5],WEST_US:[-121.96,37.35],EAST_US:[-78.45,38.13],WEST_EU:[-8,53],WEST_EU_2:[-.1,51],CENTRAL_EU:[8,50],SOUTH_ASIA:[72.88,19.08],OCEANIA:[151.2,-33.86],SOUTH_AMERICA:[-46.38,-23.34]},c={SOUTHEAST_ASIA:[103.8,1.37]},d={SOUTHEAST_ASIA:"ap-southeast-1",NORTHEAST_ASIA:"ap-northeast-1",NORTHEAST_ASIA_2:"ap-northeast-2",CENTRAL_CANADA:"ca-central-1",WEST_US:"us-west-1",EAST_US:"us-east-1",WEST_EU:"eu-west-1",WEST_EU_2:"eu-west-2",CENTRAL_EU:"eu-central-1",SOUTH_ASIA:"ap-south-1",OCEANIA:"ap-southeast-2",SOUTH_AMERICA:"sa-east-1"},u={SOUTHEAST_ASIA:"sin"},p=Object.keys(n.Wp).map(e=>({key:e,name:null===n.Wp||void 0===n.Wp?void 0:n.Wp[e],region:d[e],coordinates:r[e]})).filter(e=>void 0!==e.coordinates)},51113:function(e,o,t){var n=t(52322),s=t(24459),i=t(34291),l=t.n(i),a=t(39097),r=t.n(a),c=t(5632),d=t(2784),u=t(26120),p=t(27792),v=t(12467),h=t(79378),m=t(56599),x=t(54511),f=t(16166),g=t(80203),j=t(14279),b=t(238),N=t(95647),w=t(75683);o.Z=e=>{var o;let{variant:t="regular",additionalOptions:i=[],onSelectId:a=l()}=e,_=(0,c.useRouter)(),{ref:y}=(0,s.UO)(),[S,C]=(0,d.useState)(!1),A=(0,w.TF)(),I=A.selectedDatabaseId,{data:P,isLoading:E,isSuccess:T}=(0,b.b)({projectRef:y}),U=null!=P?P:[],k=U.sort((e,o)=>e.inserted_at>o.inserted_at?1:0).sort(e=>e.identifier===y?-1:0),R=U.find(e=>e.identifier===I),D=(0,N.f)(null!==(o=null==R?void 0:R.region)&&void 0!==o?o:""),Z=(0,N.U)(null!=I?I:""),O=i.find(e=>e.id===I);return(0,n.jsxs)(u.J2,{open:S,onOpenChange:C,modal:!1,children:[(0,n.jsx)(u.xo,{asChild:!0,children:(0,n.jsx)("div",{className:"flex items-center space-x-2 cursor-pointer",children:(0,n.jsxs)(p.z,{type:"default",className:(0,v.cn)("pr-2","connected-on-right"===t&&"rounded-r-none","connected-on-left"===t&&"rounded-l-none border-l-0","connected-on-both"===t&&"rounded-none border-x-0"),icon:E&&(0,n.jsx)(h.Z,{className:"animate-spin"}),iconRight:(0,n.jsx)(m.Z,{className:"text-foreground-light",strokeWidth:2,size:12}),children:["Source:"," ",O?(0,n.jsx)("span",{children:O.name}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"capitalize",children:E||(null==R?void 0:R.identifier)===y?"Primary database":"Read replica"})," ",T&&(null==R?void 0:R.identifier)!==y&&(0,n.jsxs)("span",{children:["(",D," - ",Z,")"]})]})]})})}),(0,n.jsx)(u.yk,{className:"p-0 w-64",side:"bottom",align:"end",children:(0,n.jsx)(x.mY,{children:(0,n.jsxs)(x.e8,{children:[i.length>0&&(0,n.jsx)(x.fu,{className:"border-b",children:i.map(e=>(0,n.jsx)(x.di,{value:e.id,className:"cursor-pointer w-full",onSelect:()=>{A.setSelectedDatabaseId(e.id),C(!1)},onClick:()=>{A.setSelectedDatabaseId(e.id),C(!1)},children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{children:e.name}),e.id===I&&(0,n.jsx)(f.Z,{})]})},e.id))}),(0,n.jsx)(x.fu,{children:(0,n.jsx)(g.x,{className:(U||[]).length>7?"h-[210px]":"",children:null==k?void 0:k.map(e=>{let o=(0,N.f)(e.region),t=(0,N.U)(e.identifier);return(0,n.jsx)(x.di,{value:e.identifier,className:"cursor-pointer w-full",onSelect:()=>{A.setSelectedDatabaseId(e.identifier),C(!1),a(e.identifier)},onClick:()=>{A.setSelectedDatabaseId(e.identifier),C(!1),a(e.identifier)},children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{children:e.identifier===y?"Primary database":"Read replica (".concat(o," - ").concat(t,")")}),e.identifier===I&&(0,n.jsx)(f.Z,{})]})},e.identifier)})})}),(0,n.jsx)(x.fu,{className:"border-t",children:(0,n.jsx)(x.di,{className:"cursor-pointer w-full",onSelect:()=>{C(!1),_.push("/project/".concat(y,"/settings/infrastructure"))},onClick:()=>C(!1),children:(0,n.jsxs)(r(),{href:"/project/".concat(y,"/settings/infrastructure"),onClick:()=>C(!1),className:"w-full flex items-center gap-2",children:[(0,n.jsx)(j.Z,{size:14,strokeWidth:1.5}),(0,n.jsx)("p",{children:"Create a new read replica"})]})})})]})})})]})}},67072:function(e,o,t){t.d(o,{Y:function(){return a}});var n=t(36492),s=t(49422),i=t(96331);async function l(e,o){let{projectRef:t}=e;if(!t)throw Error("Project ref is required");let{data:n,error:i}=await (0,s.U2)("/platform/projects/{ref}/config/supavisor",{params:{path:{ref:t}},signal:o});return i&&(0,s.S3)(i),n}let a=function(e){let{projectRef:o}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(i.A.poolingConfiguration(o),e=>{let{signal:t}=e;return l({projectRef:o},t)},{enabled:t&&void 0!==o,...s})}},11064:function(e,o,t){t.d(o,{Z:function(){return n}});let n={list:e=>["project",e,"replicas"],statuses:e=>["project",e,"replicas-statuses"],loadBalancers:e=>["project",e,"load-balancers"]}},238:function(e,o,t){t.d(o,{b:function(){return r}});var n=t(36492),s=t(49422),i=t(76501),l=t(11064);async function a(e,o){let{projectRef:t}=e;if(!t)throw Error("Project ref is required");let{data:n,error:i}=await (0,s.U2)("/platform/projects/{ref}/databases",{params:{path:{ref:t}},signal:o});if(i)throw i;return n}let r=function(e){let{projectRef:o}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r}=(0,i.ix)({ref:o});return(0,n.a)(l.Z.list(o),e=>{let{signal:t}=e;return a({projectRef:o},t)},{enabled:t&&(null==r?void 0:r.is_read_replicas_enabled)&&void 0!==o,...s})}},95647:function(e,o,t){t.d(o,{U:function(){return l},f:function(){return a}});var n=t(42200),s=t(56974),i=t.n(s);let l=e=>{var o;return i()(null!==(o=e.split("-"))&&void 0!==o?o:[])},a=e=>{var o,t;return null===(o=i()(null===(t=n.q_.find(o=>o.region===e))||void 0===t?void 0:t.name.split("(")))||void 0===o?void 0:o.split(")")[0]}},95522:function(e,o,t){t.d(o,{mM:function(){return a}}),t(52322);var n=t(2784),s=t(9162),i=t(4741);t(24459);let l=(0,n.createContext)(function(){let e=(0,s.sj)({usePoolerConnection:!0,setUsePoolerConnection:o=>{e.usePoolerConnection=o},showPoolingModeHelper:!1,setShowPoolingModeHelper:o=>{e.showPoolingModeHelper=o}});return e}());function a(e){let o=(0,n.useContext)(l);return(0,i.R)(o,e)}}}]);